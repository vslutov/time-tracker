(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(25),o=n.n(c),i=n(17),s=(n(89),n(67)),l=n(23),u=n(35),m=n(116),d=n(12),f=n(28),b=n(115),h=n(117),E=n(118),p=n(119),g=n(120),v=n(58),w=function(){var e=Object(a.useState)(!1),t=Object(f.a)(e,2),n=t[0],c=t[1];return r.a.createElement(b.a,{color:"light",light:!0,expand:"md"},r.a.createElement(m.a,null,r.a.createElement(v.a,{to:"/time-tracker/",className:"navbar-brand"},"Time tracker"),r.a.createElement(h.a,{onClick:function(){c(!n)}}),r.a.createElement(E.a,{isOpen:n,navbar:!0},r.a.createElement(p.a,{navbar:!0},r.a.createElement(g.a,null,r.a.createElement(v.b,{to:"/time-tracker/settings",className:"nav-link"},"Settings"))))))},k=n(20),O=n(129),j=n(127),y=n(130),S=n(131),T=n(132),x=n(128),C=n(124),M=n(126),N=n(122),R=n(71),U=n(121),I=n(135),W=n(123),_=n(125),A=n(54),F=n(72),V=n.n(F),D=function(e){var t=e.type,n=void 0===t?"text":t,c=e.className,o=void 0===c?"":c;return function(e){var t=e.input,c=e.meta;return r.a.createElement(a.Fragment,null,r.a.createElement(U.a,Object.assign({type:n,id:t.name},t,{className:o})),c.touched&&c.error&&r.a.createElement(I.a,{color:"danger"},c.error),!c.dirtySinceLastSubmit&&c.submitError&&r.a.createElement(I.a,{color:"danger"},c.submitError))}},P=D({type:"text"}),L=D({type:"password"}),z=D({type:"textarea",className:V.a.textarea}),G=function(e){var t=e.label,n=e.component,a=e.name,c=e.validate;return r.a.createElement(N.a,{row:!0},r.a.createElement(W.a,{htmlFor:a,sm:2},t),r.a.createElement(C.a,{sm:10},r.a.createElement(A.a,{name:a,component:n,validate:c})))},B=function(e){var t=e.onSubmit,n=e.initialValues,a=e.children,c=e.submitText,o=void 0===c?"":c,i=e.allowPristine,s=void 0!==i&&i;return r.a.createElement(A.b,{onSubmit:t,initialValues:n,render:function(e){var t=e.handleSubmit,n=e.errors,c=e.pristine,i=(Object(R.a)(e,["handleSubmit","errors","pristine"]),Object.keys(n).length>0||c&&!s);return r.a.createElement(_.a,{onSubmit:t},a,o.length>0?r.a.createElement(N.a,{row:!0},r.a.createElement(C.a,{sm:{size:10,offset:2}},r.a.createElement(M.a,{outline:!0,color:"primary",type:"submit",disabled:i},r.a.createElement(j.a,{width:24,height:24})," "+o))):null)}})},J=function(e){var t=e.meta.active,n=e.input,r=e.render,c=Object(a.useState)(t),o=Object(f.a)(c,2),i=o[0],s=o[1];return i&&!t&&r(n.value),i!==t&&s(t),null},K=function(e){var t=e.name,n=e.render;return r.a.createElement(A.a,{name:t,subscription:{active:!0,value:!0},render:function(e){return r.a.createElement(J,Object.assign({},e,{render:n}))}})},X=n(13),$=Object(k.c)({prefix:"TRACKER",defaultValues:{startTime:null,completeTime:null,message:"",editedMessage:""}}),H=$.setActions,Y=$.trackerReducer,Z=$.defaultSelectors,q=Object(X.a)({},H,{startWork:function(){return H.setStartTime(+new Date)},completeWork:function(){return H.setCompleteTime(+new Date)},continueWork:function(){return H.setCompleteTime(null)},reset:function(){return[H.setStartTime(null),H.setCompleteTime(null),H.setMessage(""),H.setEditedMessage("")]}}),Q=Object(l.c)(Object(k.a)(Z),Object(k.b)(q))(function(e){var t=e.startWork,n=e.startTime,c=e.message,o=e.setMessage,i=e.completeWork,s=e.completeTime,l=e.reset,u=e.continueWork,m=e.editedMessage,d=e.setEditedMessage,b=Object(a.useState)(!1),h=Object(f.a)(b,2),E=h[0],p=h[1],g=function(){return p(!0)};if(E)return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,null,r.a.createElement(C.a,null,r.a.createElement("p",null,"Are you sure want reset progress? This action cannot be undone."))),r.a.createElement(x.a,null,r.a.createElement(C.a,null,r.a.createElement(M.a,{outline:!0,color:"secondary",onClick:function(){return p(!1)}},r.a.createElement(O.a,{width:24,height:24})," Cancel"),r.a.createElement(M.a,{outline:!0,color:"danger",onClick:function(){l(),p(!1)},className:"ml-2"},r.a.createElement(j.a,{width:24,height:24})," Reset progress"))));if(null==n)return r.a.createElement(x.a,null,r.a.createElement(C.a,null,r.a.createElement(M.a,{outline:!0,color:"primary",onClick:t},r.a.createElement(y.a,{width:24,height:24})," Start work session")));if(null!=s)return r.a.createElement(B,{onSubmit:function(){return null},initialValues:{editedMessage:m}},r.a.createElement(G,{label:"Edit message, if needed",component:z,name:"editedMessage"}),r.a.createElement(K,{name:"editedMessage",render:d}),r.a.createElement(N.a,{row:!0},r.a.createElement(C.a,{sm:{size:10,offset:2}},r.a.createElement(M.a,{color:"primary",outline:!0,type:"submit"},r.a.createElement(j.a,{width:24,height:24}),"Commit workday"),r.a.createElement(M.a,{color:"secondary",outline:!0,onClick:u,className:"ml-2"},r.a.createElement(S.a,{width:24,height:24}),"Continue work"),r.a.createElement(M.a,{color:"danger",outline:!0,onClick:g,className:"ml-2"},r.a.createElement(T.a,{width:24,height:24}),"Reset progress"))));return r.a.createElement(B,{onSubmit:i,initialValues:{message:c}},r.a.createElement(G,{label:"Write there the tasks, which you have done by the day",component:z,name:"message"}),r.a.createElement(K,{name:"message",render:o}),r.a.createElement(N.a,{row:!0},r.a.createElement(C.a,{sm:{size:10,offset:2}},r.a.createElement(M.a,{color:"primary",outline:!0,type:"submit"},r.a.createElement(j.a,{width:24,height:24})," Finish workday"),r.a.createElement(M.a,{color:"danger",outline:!0,onClick:g,className:"ml-2"},r.a.createElement(T.a,{width:24,height:24})," Reset progress"))))}),ee=n(18),te=n.n(ee),ne=n(26),ae=n(73),re=n(81),ce=n(44),oe=n(9),ie=n(74),se=n(80),le=n(45),ue=n.n(le),me=new RegExp("^(https?://[^/]+)/([^/]+)/([^/]+)/issues/([0-9]+)$"),de=function(e){var t=e.match(me);if(null==t)return null;var n=Object(f.a)(t,5),a=n[1],r=n[2],c=n[3],o=n[4];return{origin:a,projectId:"".concat(r,"%2F").concat(c),id:o}},fe=function(e){function t(e,n){var a;return Object(ae.a)(this,t),(a=Object(re.a)(this,Object(ce.a)(t).call(this,e))).name=a.constructor.name,Error.captureStackTrace(Object(oe.a)(a),a.constructor),a.info=n||500,a}return Object(ie.a)(t,e),t}(Object(se.a)(Error)),be=function(){var e=Object(ne.a)(te.a.mark(function e(t){var n,a,r,c,o,i,s,l,u;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.issueUrl,a=t.token,null!=(r=de(n))){e.next=4;break}throw new fe("Invalid issue url",{issueUrl:"Invalid issue url"});case 4:return c=r.origin,o=r.projectId,i=r.id,e.next=7,ue()("".concat(c,"/api/v4/projects/").concat(o,"/issues/").concat(i),{headers:{"PRIVATE-TOKEN":a}});case 7:if(s=e.sent,console.log(s),404!==s.status){e.next=13;break}throw new fe("Cannot find an issue",{issueUrl:"Cannot find an issue"});case 13:if(401!==s.status){e.next=17;break}throw fe("Invalid token",{token:"Invalid token"});case 17:if(s.ok){e.next=19;break}throw new fe("Some internal error",{FORM_ERROR:"Some internal error"});case 19:return e.next=21,s.json();case 21:return l=e.sent,u=l.title,e.abrupt("return",u);case 24:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),he=function(e){if(null==e.match(me))return"It isn't a valid issue url."},Ee=function(e){return function(){var t=Object(ne.a)(te.a.mark(function t(n){var a,r,c;return te.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.issueUrl,r=n.token,t.prev=1,t.next=4,be({issueUrl:a,token:r});case 4:return c=t.sent,t.next=7,e({issueUrl:a,token:r,issueTitle:c});case 7:t.next=14;break;case 9:if(t.prev=9,t.t0=t.catch(1),!(t.t0 instanceof fe)){t.next=13;break}return t.abrupt("return",t.t0);case 13:throw t.t0;case 14:case"end":return t.stop()}},t,null,[[1,9]])}));return function(e){return t.apply(this,arguments)}}()},pe=n(42),ge=Object(k.c)({prefix:"SETTINGS",defaultValues:{issueUrl:"",token:"",issueTitle:""}}),ve=ge.setActions,we=ge.settingsReducer,ke=ge.defaultSelectors,Oe=Object(X.a)({},ve,{saveSettings:function(){var e=Object(ne.a)(te.a.mark(function e(t){var n,a,r;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.issueUrl,a=t.token,r=t.issueTitle,e.abrupt("return",[ve.setIssueUrl(n),ve.setToken(a),ve.setIssueTitle(r)]);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}),je=Object(X.a)({},ke,{issueInfo:Object(pe.a)(ke.issueUrl,de)}),ye=Object(l.c)(Object(k.a)(je),Object(k.b)(Oe))(function(e){var t=e.issueUrl,n=e.token,a=e.saveSettings,c=e.issueTitle,o={issueUrl:t,token:n};return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{className:"mb-3"},r.a.createElement(C.a,{sm:2},"Current issue"),r.a.createElement(C.a,{sm:10},c)),r.a.createElement(B,{onSubmit:Ee(a),initialValues:o,submitText:"Save"},r.a.createElement(G,{label:"Gitlab token",component:L,name:"token"}),r.a.createElement(G,{label:"Gitlab issue url",component:P,name:"issueUrl",validate:he})))}),Se=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(w,null),r.a.createElement(m.a,{className:"mt-3"},r.a.createElement(d.c,null,r.a.createElement(d.a,{path:"/time-tracker/settings",component:ye}),r.a.createElement(d.a,{component:Q}))))},Te=n(22),xe=n(79),Ce=n(30),Me=n(75),Ne=n.n(Me),Re=n(134),Ue=n(133),Ie=n(76),We=n(77),_e=Object(Re.a)(function(e,t){return e.pipe(Object(Ie.a)(q.setCompleteTime),Object(We.a)(function(e){var n=e.payload,a=Z.startTime(t.value),r=Z.message(t.value),c=10*Math.ceil((n-a)/6e5),o=Math.floor(c/60),i=c-60*o,s=function(e){var t=e.getFullYear(),n="".concat(Math.floor(e.getMonth()/10)).concat(e.getMonth()%10),a="".concat(Math.floor(e.getDate()/10)).concat(e.getDate()%10);return"".concat(t,"-").concat(n,"-").concat(a)}(new Date(a)),l="".concat(r,"\n/spend ").concat(o,"h").concat(i,"m ").concat(s);return q.setEditedMessage(l)}))}),Ae=null!=window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Te.d,Fe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ve(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var De=Object(i.a)(),Pe=function(e){var t=e.history,n=e.preloadedState,a=Object(Ue.a)(),r=Ae(Ne()(),Object(Te.a)(a,Ce.batch,Object(xe.a)(t))),c=function(e){return Object(Ce.batching)(Object(Te.c)({router:Object(u.b)(e),tracker:Y,settings:we}))}(t),o=null!=n?Object(Te.e)(c,n,r):Object(Te.e)(c,r);return a.run(_e),o}({history:De});o.a.render(r.a.createElement(function(e){var t=e.store,n=e.history;return r.a.createElement(s.a,null,r.a.createElement(l.a,{store:t},r.a.createElement(u.a,{history:n},r.a.createElement(Se,null))))},{history:De,store:Pe}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/time-tracker",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/time-tracker","/service-worker.js");Fe?(function(e,t){ue()(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Ve(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):Ve(t,e)})}}()},72:function(e,t,n){e.exports={textarea:"Form_textarea__3Z_Hf"}},84:function(e,t,n){e.exports=n(111)}},[[84,1,2]]]);
//# sourceMappingURL=main.344e6935.chunk.js.map